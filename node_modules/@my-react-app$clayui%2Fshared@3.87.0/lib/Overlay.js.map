{"version":3,"sources":["Overlay.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","Object","defineProperty","exports","value","Overlay","_ariaHidden","require","_react","_interopRequireWildcard","_Keys","_Portal","_useInteractOutside","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","hasOwnProperty","call","desc","set","overlayStack","_ref","children","_ref$isCloseOnInterac","isCloseOnInteractOutside","_ref$isKeyboardDismis","isKeyboardDismiss","_ref$isModal","isModal","_ref$isOpen","isOpen","menuClassName","menuRef","onClose","portalRef","suppress","triggerRef","unsuppressCallbackRef","useRef","onHide","useCallback","action","length","useEvent","event","_portalRef$current","current","contains","target","Keys","Esc","stopImmediatePropagation","preventDefault","focus","useInteractOutside","isDisabled","onInteract","onInteractStart","stopPropagation","ref","useEffect","push","index","indexOf","splice","elements","map","supportsInert","suppressOthers","hideOthers","createElement","ClayPortal","className","subPortalRef","tabIndex","name","onEvent","conditional","capture","deps","arguments","undefined","document","addEventListener","removeEventListener"],"mappings":"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","file":"Overlay.js","sourcesContent":["\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Overlay = Overlay;\n\nvar _ariaHidden = require(\"aria-hidden\");\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _Keys = require(\"./Keys\");\n\nvar _Portal = require(\"./Portal\");\n\nvar _useInteractOutside = require(\"./useInteractOutside\");\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\n/**\n * SPDX-FileCopyrightText: Â© 2022 Liferay, Inc. <https://liferay.com>\n * SPDX-License-Identifier: BSD-3-Clause\n */\nvar overlayStack = [];\n/**\n * Overlay component is used for components like dialog and modal.\n * For example, Autocomplete, DatePicker, ColorPicker, DropDown are components\n * that can use and have the same consistent behavior.\n */\n\nfunction Overlay(_ref) {\n  var children = _ref.children,\n      _ref$isCloseOnInterac = _ref.isCloseOnInteractOutside,\n      isCloseOnInteractOutside = _ref$isCloseOnInterac === void 0 ? false : _ref$isCloseOnInterac,\n      _ref$isKeyboardDismis = _ref.isKeyboardDismiss,\n      isKeyboardDismiss = _ref$isKeyboardDismis === void 0 ? false : _ref$isKeyboardDismis,\n      _ref$isModal = _ref.isModal,\n      isModal = _ref$isModal === void 0 ? false : _ref$isModal,\n      _ref$isOpen = _ref.isOpen,\n      isOpen = _ref$isOpen === void 0 ? false : _ref$isOpen,\n      menuClassName = _ref.menuClassName,\n      menuRef = _ref.menuRef,\n      onClose = _ref.onClose,\n      portalRef = _ref.portalRef,\n      suppress = _ref.suppress,\n      triggerRef = _ref.triggerRef;\n  var unsuppressCallbackRef = (0, _react.useRef)(null);\n  var onHide = (0, _react.useCallback)(function (action) {\n    if (overlayStack[overlayStack.length - 1] === menuRef) {\n      onClose(action);\n    }\n  }, [onClose]);\n  useEvent('focus', (0, _react.useCallback)(function (event) {\n    var _portalRef$current;\n\n    if (portalRef && !((_portalRef$current = portalRef.current) !== null && _portalRef$current !== void 0 && _portalRef$current.contains(event.target)) && triggerRef.current && !triggerRef.current.contains(event.target)) {\n      onHide('blur');\n    }\n  }, [onHide]), isOpen, true, [isOpen, onHide]);\n  useEvent('keydown', (0, _react.useCallback)(function (event) {\n    if (event.key === _Keys.Keys.Esc && overlayStack[overlayStack.length - 1] === menuRef) {\n      event.stopImmediatePropagation();\n      event.preventDefault();\n\n      if (triggerRef.current) {\n        // When inert is used to suppress user interaction with the rest of\n        // the document, to retrieve the focus in the trigger we need to\n        // first undo and then move the focus.\n        if (unsuppressCallbackRef.current) {\n          unsuppressCallbackRef.current();\n          unsuppressCallbackRef.current = null;\n        }\n\n        triggerRef.current.focus();\n      }\n\n      onClose('escape');\n    }\n  }, [onClose]), isOpen && isKeyboardDismiss, true, [isOpen, onClose]);\n  (0, _useInteractOutside.useInteractOutside)({\n    isDisabled: isOpen ? !isCloseOnInteractOutside : true,\n    onInteract: function onInteract() {\n      onHide('blur');\n    },\n    onInteractStart: function onInteractStart(event) {\n      if (overlayStack[overlayStack.length - 1] === menuRef && isModal) {\n        event.stopPropagation();\n        event.preventDefault();\n      }\n    },\n    ref: portalRef !== null && portalRef !== void 0 ? portalRef : menuRef,\n    triggerRef: triggerRef\n  });\n  (0, _react.useEffect)(function () {\n    if (isOpen) {\n      overlayStack.push(menuRef);\n    }\n\n    return function () {\n      var index = overlayStack.indexOf(menuRef);\n\n      if (index >= 0) {\n        overlayStack.splice(index, 1);\n      }\n    };\n  }, [isOpen, menuRef]);\n  (0, _react.useEffect)(function () {\n    if (menuRef.current && isOpen) {\n      var elements = suppress ? suppress.map(function (ref) {\n        return ref.current;\n      }) : menuRef.current; // Inert is a new native feature to better handle DOM arias that are not\n      // assertive to a SR or that should ignore any user interaction.\n      // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/inert\n\n      if (isModal && (0, _ariaHidden.supportsInert)()) {\n        unsuppressCallbackRef.current = (0, _ariaHidden.suppressOthers)(elements);\n        return function () {\n          if (unsuppressCallbackRef.current) {\n            unsuppressCallbackRef.current();\n          }\n\n          unsuppressCallbackRef.current = null;\n        };\n      } else {\n        return (0, _ariaHidden.hideOthers)(elements);\n      }\n    }\n  }, [isModal, isOpen]);\n  return /*#__PURE__*/_react.default.createElement(_Portal.ClayPortal, {\n    className: menuClassName,\n    subPortalRef: portalRef\n  }, isModal && /*#__PURE__*/_react.default.createElement(\"span\", {\n    \"aria-hidden\": \"true\",\n    \"data-focus-scope-start\": \"true\",\n    tabIndex: 0\n  }), children, isModal && /*#__PURE__*/_react.default.createElement(\"span\", {\n    \"aria-hidden\": \"true\",\n    \"data-focus-scope-end\": \"true\",\n    tabIndex: 0\n  }));\n}\n\nfunction useEvent(name, onEvent, conditional, capture) {\n  var deps = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : [];\n  (0, _react.useEffect)(function () {\n    // This check should go away when the Overlay is shown using conditional\n    // instead of class CSS.\n    if (conditional) {\n      document.addEventListener(name, onEvent, capture);\n      return function () {\n        document.removeEventListener(name, onEvent, capture);\n      };\n    }\n  }, deps);\n}"]}