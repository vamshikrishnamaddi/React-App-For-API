{"version":3,"sources":["index.js"],"names":["processFn","fn","P","opts","that","args","Array","arguments","length","i","resolve","reject","push","err","result","multiArgs","results","apply","pify","module","exports","obj","Promise","exclude","filter","key","match","pattern","test","include","some","ret","excludeMain","Object","keys","reduce","x","all"],"mappings":"AAAA;;;;;;AAEA,MAAIA,YAAY,UAAUC,EAAV,EAAcC,CAAd,EAAiBC,IAAjB,EAAuB;AACtC,UAAO,YAAY;AAClB,QAAIC,OAAO,IAAX;AACA,QAAIC,OAAO,IAAIC,KAAJ,CAAUC,UAAUC,MAApB,CAAX;;AAEA,SAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIF,UAAUC,MAA9B,EAAsCC,GAAtC,EAA2C;AAC1CJ,UAAKI,CAAL,IAAUF,UAAUE,CAAV,CAAV;AACA;;AAED,WAAO,IAAIP,CAAJ,CAAM,UAAUQ,OAAV,EAAmBC,MAAnB,EAA2B;AACvCN,UAAKO,IAAL,CAAU,UAAUC,GAAV,EAAeC,MAAf,EAAuB;AAChC,UAAID,GAAJ,EAAS;AACRF,cAAOE,GAAP;AACA,OAFD,MAEO,IAAIV,KAAKY,SAAT,EAAoB;AAC1B,WAAIC,UAAU,IAAIV,KAAJ,CAAUC,UAAUC,MAAV,GAAmB,CAA7B,CAAd;;AAEA,YAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIF,UAAUC,MAA9B,EAAsCC,GAAtC,EAA2C;AAC1CO,gBAAQP,IAAI,CAAZ,IAAiBF,UAAUE,CAAV,CAAjB;AACA;;AAEDC,eAAQM,OAAR;AACA,OARM,MAQA;AACNN,eAAQI,MAAR;AACA;AACD,MAdD;;AAgBAb,QAAGgB,KAAH,CAASb,IAAT,EAAeC,IAAf;AACA,KAlBM,CAAP;AAmBA,IA3BD;AA4BA,GA7BD;;AA+BA,MAAIa,OAAOC,OAAOC,OAAP,GAAiB,UAAUC,GAAV,EAAenB,CAAf,EAAkBC,IAAlB,EAAwB;AACnD,OAAI,OAAOD,CAAP,KAAa,UAAjB,EAA6B;AAC5BC,WAAOD,CAAP;AACAA,QAAIoB,OAAJ;AACA;;AAEDnB,UAAOA,QAAQ,EAAf;AACAA,QAAKoB,OAAL,GAAepB,KAAKoB,OAAL,IAAgB,CAAC,SAAD,CAA/B;;AAEA,OAAIC,SAAS,UAAUC,GAAV,EAAe;AAC3B,QAAIC,QAAQ,UAAUC,OAAV,EAAmB;AAC9B,YAAO,OAAOA,OAAP,KAAmB,QAAnB,GAA8BF,QAAQE,OAAtC,GAAgDA,QAAQC,IAAR,CAAaH,GAAb,CAAvD;AACA,KAFD;;AAIA,WAAOtB,KAAK0B,OAAL,GAAe1B,KAAK0B,OAAL,CAAaC,IAAb,CAAkBJ,KAAlB,CAAf,GAA0C,CAACvB,KAAKoB,OAAL,CAAaO,IAAb,CAAkBJ,KAAlB,CAAlD;AACA,IAND;;AAQA,OAAIK,MAAM,OAAOV,GAAP,KAAe,UAAf,GAA4B,YAAY;AACjD,QAAIlB,KAAK6B,WAAT,EAAsB;AACrB,YAAOX,IAAIJ,KAAJ,CAAU,IAAV,EAAgBV,SAAhB,CAAP;AACA;;AAED,WAAOP,UAAUqB,GAAV,EAAenB,CAAf,EAAkBC,IAAlB,EAAwBc,KAAxB,CAA8B,IAA9B,EAAoCV,SAApC,CAAP;AACA,IANS,GAMN,EANJ;;AAQA,UAAO0B,OAAOC,IAAP,CAAYb,GAAZ,EAAiBc,MAAjB,CAAwB,UAAUJ,GAAV,EAAeN,GAAf,EAAoB;AAClD,QAAIW,IAAIf,IAAII,GAAJ,CAAR;;AAEAM,QAAIN,GAAJ,IAAW,OAAOW,CAAP,KAAa,UAAb,IAA2BZ,OAAOC,GAAP,CAA3B,GAAyCzB,UAAUoC,CAAV,EAAalC,CAAb,EAAgBC,IAAhB,CAAzC,GAAiEiC,CAA5E;;AAEA,WAAOL,GAAP;AACA,IANM,EAMJA,GANI,CAAP;AAOA,GAhCD;;AAkCAb,OAAKmB,GAAL,GAAWnB,IAAX","file":"index.js","sourcesContent":["'use strict';\n\nvar processFn = function (fn, P, opts) {\n\treturn function () {\n\t\tvar that = this;\n\t\tvar args = new Array(arguments.length);\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\targs[i] = arguments[i];\n\t\t}\n\n\t\treturn new P(function (resolve, reject) {\n\t\t\targs.push(function (err, result) {\n\t\t\t\tif (err) {\n\t\t\t\t\treject(err);\n\t\t\t\t} else if (opts.multiArgs) {\n\t\t\t\t\tvar results = new Array(arguments.length - 1);\n\n\t\t\t\t\tfor (var i = 1; i < arguments.length; i++) {\n\t\t\t\t\t\tresults[i - 1] = arguments[i];\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve(results);\n\t\t\t\t} else {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfn.apply(that, args);\n\t\t});\n\t};\n};\n\nvar pify = module.exports = function (obj, P, opts) {\n\tif (typeof P !== 'function') {\n\t\topts = P;\n\t\tP = Promise;\n\t}\n\n\topts = opts || {};\n\topts.exclude = opts.exclude || [/.+Sync$/];\n\n\tvar filter = function (key) {\n\t\tvar match = function (pattern) {\n\t\t\treturn typeof pattern === 'string' ? key === pattern : pattern.test(key);\n\t\t};\n\n\t\treturn opts.include ? opts.include.some(match) : !opts.exclude.some(match);\n\t};\n\n\tvar ret = typeof obj === 'function' ? function () {\n\t\tif (opts.excludeMain) {\n\t\t\treturn obj.apply(this, arguments);\n\t\t}\n\n\t\treturn processFn(obj, P, opts).apply(this, arguments);\n\t} : {};\n\n\treturn Object.keys(obj).reduce(function (ret, key) {\n\t\tvar x = obj[key];\n\n\t\tret[key] = typeof x === 'function' && filter(key) ? processFn(x, P, opts) : x;\n\n\t\treturn ret;\n\t}, ret);\n};\n\npify.all = pify;\n"]}