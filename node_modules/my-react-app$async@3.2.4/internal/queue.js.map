{"version":3,"sources":["queue.js"],"names":["Object","defineProperty","exports","value","default","queue","_onlyOnce","require","_onlyOnce2","_interopRequireDefault","_setImmediate","_setImmediate2","_DoublyLinkedList","_DoublyLinkedList2","_wrapAsync","_wrapAsync2","obj","__esModule","worker","concurrency","payload","RangeError","_worker","numRunning","workersList","events","error","drain","saturated","unsaturated","empty","on","event","handler","push","once","handleAndRemove","args","off","keys","forEach","ev","filter","trigger","processingScheduled","_insert","data","insertAtFront","rejectOnError","callback","Error","q","started","res","rej","promiseCallback","err","length","item","_createTaskItem","_tasks","unshift","process","Promise","resolve","reject","_createCB","tasks","i","l","task","index","indexOf","shift","splice","buffer","idle","_maybeDrain","eventMethod","name","isProcessing","Symbol","iterator","paused","Array","isArray","map","datum","pushAsync","kill","unshiftAsync","remove","testFn","Math","min","node","cb","running","pause","resume","defineProperties","writable","module"],"mappings":"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","file":"queue.js","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = queue;\n\nvar _onlyOnce = require('./onlyOnce.js');\n\nvar _onlyOnce2 = _interopRequireDefault(_onlyOnce);\n\nvar _setImmediate = require('./setImmediate.js');\n\nvar _setImmediate2 = _interopRequireDefault(_setImmediate);\n\nvar _DoublyLinkedList = require('./DoublyLinkedList.js');\n\nvar _DoublyLinkedList2 = _interopRequireDefault(_DoublyLinkedList);\n\nvar _wrapAsync = require('./wrapAsync.js');\n\nvar _wrapAsync2 = _interopRequireDefault(_wrapAsync);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction queue(worker, concurrency, payload) {\n    if (concurrency == null) {\n        concurrency = 1;\n    } else if (concurrency === 0) {\n        throw new RangeError('Concurrency must not be zero');\n    }\n\n    var _worker = (0, _wrapAsync2.default)(worker);\n    var numRunning = 0;\n    var workersList = [];\n    const events = {\n        error: [],\n        drain: [],\n        saturated: [],\n        unsaturated: [],\n        empty: []\n    };\n\n    function on(event, handler) {\n        events[event].push(handler);\n    }\n\n    function once(event, handler) {\n        const handleAndRemove = (...args) => {\n            off(event, handleAndRemove);\n            handler(...args);\n        };\n        events[event].push(handleAndRemove);\n    }\n\n    function off(event, handler) {\n        if (!event) return Object.keys(events).forEach(ev => events[ev] = []);\n        if (!handler) return events[event] = [];\n        events[event] = events[event].filter(ev => ev !== handler);\n    }\n\n    function trigger(event, ...args) {\n        events[event].forEach(handler => handler(...args));\n    }\n\n    var processingScheduled = false;\n    function _insert(data, insertAtFront, rejectOnError, callback) {\n        if (callback != null && typeof callback !== 'function') {\n            throw new Error('task callback must be a function');\n        }\n        q.started = true;\n\n        var res, rej;\n        function promiseCallback(err, ...args) {\n            // we don't care about the error, let the global error handler\n            // deal with it\n            if (err) return rejectOnError ? rej(err) : res();\n            if (args.length <= 1) return res(args[0]);\n            res(args);\n        }\n\n        var item = q._createTaskItem(data, rejectOnError ? promiseCallback : callback || promiseCallback);\n\n        if (insertAtFront) {\n            q._tasks.unshift(item);\n        } else {\n            q._tasks.push(item);\n        }\n\n        if (!processingScheduled) {\n            processingScheduled = true;\n            (0, _setImmediate2.default)(() => {\n                processingScheduled = false;\n                q.process();\n            });\n        }\n\n        if (rejectOnError || !callback) {\n            return new Promise((resolve, reject) => {\n                res = resolve;\n                rej = reject;\n            });\n        }\n    }\n\n    function _createCB(tasks) {\n        return function (err, ...args) {\n            numRunning -= 1;\n\n            for (var i = 0, l = tasks.length; i < l; i++) {\n                var task = tasks[i];\n\n                var index = workersList.indexOf(task);\n                if (index === 0) {\n                    workersList.shift();\n                } else if (index > 0) {\n                    workersList.splice(index, 1);\n                }\n\n                task.callback(err, ...args);\n\n                if (err != null) {\n                    trigger('error', err, task.data);\n                }\n            }\n\n            if (numRunning <= q.concurrency - q.buffer) {\n                trigger('unsaturated');\n            }\n\n            if (q.idle()) {\n                trigger('drain');\n            }\n            q.process();\n        };\n    }\n\n    function _maybeDrain(data) {\n        if (data.length === 0 && q.idle()) {\n            // call drain immediately if there are no tasks\n            (0, _setImmediate2.default)(() => trigger('drain'));\n            return true;\n        }\n        return false;\n    }\n\n    const eventMethod = name => handler => {\n        if (!handler) {\n            return new Promise((resolve, reject) => {\n                once(name, (err, data) => {\n                    if (err) return reject(err);\n                    resolve(data);\n                });\n            });\n        }\n        off(name);\n        on(name, handler);\n    };\n\n    var isProcessing = false;\n    var q = {\n        _tasks: new _DoublyLinkedList2.default(),\n        _createTaskItem(data, callback) {\n            return {\n                data,\n                callback\n            };\n        },\n        *[Symbol.iterator]() {\n            yield* q._tasks[Symbol.iterator]();\n        },\n        concurrency,\n        payload,\n        buffer: concurrency / 4,\n        started: false,\n        paused: false,\n        push(data, callback) {\n            if (Array.isArray(data)) {\n                if (_maybeDrain(data)) return;\n                return data.map(datum => _insert(datum, false, false, callback));\n            }\n            return _insert(data, false, false, callback);\n        },\n        pushAsync(data, callback) {\n            if (Array.isArray(data)) {\n                if (_maybeDrain(data)) return;\n                return data.map(datum => _insert(datum, false, true, callback));\n            }\n            return _insert(data, false, true, callback);\n        },\n        kill() {\n            off();\n            q._tasks.empty();\n        },\n        unshift(data, callback) {\n            if (Array.isArray(data)) {\n                if (_maybeDrain(data)) return;\n                return data.map(datum => _insert(datum, true, false, callback));\n            }\n            return _insert(data, true, false, callback);\n        },\n        unshiftAsync(data, callback) {\n            if (Array.isArray(data)) {\n                if (_maybeDrain(data)) return;\n                return data.map(datum => _insert(datum, true, true, callback));\n            }\n            return _insert(data, true, true, callback);\n        },\n        remove(testFn) {\n            q._tasks.remove(testFn);\n        },\n        process() {\n            // Avoid trying to start too many processing operations. This can occur\n            // when callbacks resolve synchronously (#1267).\n            if (isProcessing) {\n                return;\n            }\n            isProcessing = true;\n            while (!q.paused && numRunning < q.concurrency && q._tasks.length) {\n                var tasks = [],\n                    data = [];\n                var l = q._tasks.length;\n                if (q.payload) l = Math.min(l, q.payload);\n                for (var i = 0; i < l; i++) {\n                    var node = q._tasks.shift();\n                    tasks.push(node);\n                    workersList.push(node);\n                    data.push(node.data);\n                }\n\n                numRunning += 1;\n\n                if (q._tasks.length === 0) {\n                    trigger('empty');\n                }\n\n                if (numRunning === q.concurrency) {\n                    trigger('saturated');\n                }\n\n                var cb = (0, _onlyOnce2.default)(_createCB(tasks));\n                _worker(data, cb);\n            }\n            isProcessing = false;\n        },\n        length() {\n            return q._tasks.length;\n        },\n        running() {\n            return numRunning;\n        },\n        workersList() {\n            return workersList;\n        },\n        idle() {\n            return q._tasks.length + numRunning === 0;\n        },\n        pause() {\n            q.paused = true;\n        },\n        resume() {\n            if (q.paused === false) {\n                return;\n            }\n            q.paused = false;\n            (0, _setImmediate2.default)(q.process);\n        }\n    };\n    // define these as fixed properties, so people get useful errors when updating\n    Object.defineProperties(q, {\n        saturated: {\n            writable: false,\n            value: eventMethod('saturated')\n        },\n        unsaturated: {\n            writable: false,\n            value: eventMethod('unsaturated')\n        },\n        empty: {\n            writable: false,\n            value: eventMethod('empty')\n        },\n        drain: {\n            writable: false,\n            value: eventMethod('drain')\n        },\n        error: {\n            writable: false,\n            value: eventMethod('error')\n        }\n    });\n    return q;\n}\nmodule.exports = exports['default'];"]}