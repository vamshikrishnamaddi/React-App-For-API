{"version":3,"sources":["waterfall.js"],"names":["Object","defineProperty","exports","value","_once","require","_once2","_interopRequireDefault","_onlyOnce","_onlyOnce2","_wrapAsync","_wrapAsync2","_awaitify","_awaitify2","obj","__esModule","default","waterfall","tasks","callback","Array","isArray","Error","length","taskIndex","nextTask","args","task","next","err","module"],"mappings":"AAAA;;;;;;AAEAA,eAAOC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AACzCC,mBAAO;AADkC,SAA7C;;AAIA,YAAIC,QAAQC,QAAQ,iBAAR,CAAZ;;AAEA,YAAIC,SAASC,uBAAuBH,KAAvB,CAAb;;AAEA,YAAII,YAAYH,QAAQ,qBAAR,CAAhB;;AAEA,YAAII,aAAaF,uBAAuBC,SAAvB,CAAjB;;AAEA,YAAIE,aAAaL,QAAQ,sBAAR,CAAjB;;AAEA,YAAIM,cAAcJ,uBAAuBG,UAAvB,CAAlB;;AAEA,YAAIE,YAAYP,QAAQ,qBAAR,CAAhB;;AAEA,YAAIQ,aAAaN,uBAAuBK,SAAvB,CAAjB;;AAEA,iBAASL,sBAAT,CAAgCO,GAAhC,EAAqC;AAAE,mBAAOA,OAAOA,IAAIC,UAAX,GAAwBD,GAAxB,GAA8B,EAAEE,SAASF,GAAX,EAArC;AAAwD;;AAE/F;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyDA,iBAASG,SAAT,CAAmBC,KAAnB,EAA0BC,QAA1B,EAAoC;AAChCA,uBAAW,CAAC,GAAGb,OAAOU,OAAX,EAAoBG,QAApB,CAAX;AACA,gBAAI,CAACC,MAAMC,OAAN,CAAcH,KAAd,CAAL,EAA2B,OAAOC,SAAS,IAAIG,KAAJ,CAAU,2DAAV,CAAT,CAAP;AAC3B,gBAAI,CAACJ,MAAMK,MAAX,EAAmB,OAAOJ,UAAP;AACnB,gBAAIK,YAAY,CAAhB;;AAEA,qBAASC,QAAT,CAAkBC,IAAlB,EAAwB;AACpB,oBAAIC,OAAO,CAAC,GAAGhB,YAAYK,OAAhB,EAAyBE,MAAMM,WAAN,CAAzB,CAAX;AACAG,qBAAK,GAAGD,IAAR,EAAc,CAAC,GAAGjB,WAAWO,OAAf,EAAwBY,IAAxB,CAAd;AACH;;AAED,qBAASA,IAAT,CAAcC,GAAd,EAAmB,GAAGH,IAAtB,EAA4B;AACxB,oBAAIG,QAAQ,KAAZ,EAAmB;AACnB,oBAAIA,OAAOL,cAAcN,MAAMK,MAA/B,EAAuC;AACnC,2BAAOJ,SAASU,GAAT,EAAc,GAAGH,IAAjB,CAAP;AACH;AACDD,yBAASC,IAAT;AACH;;AAEDD,qBAAS,EAAT;AACH;;AAEDvB,gBAAQc,OAAR,GAAkB,CAAC,GAAGH,WAAWG,OAAf,EAAwBC,SAAxB,CAAlB;AACAa,eAAO5B,OAAP,GAAiBA,QAAQ,SAAR,CAAjB","file":"waterfall.js","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _once = require('./internal/once.js');\n\nvar _once2 = _interopRequireDefault(_once);\n\nvar _onlyOnce = require('./internal/onlyOnce.js');\n\nvar _onlyOnce2 = _interopRequireDefault(_onlyOnce);\n\nvar _wrapAsync = require('./internal/wrapAsync.js');\n\nvar _wrapAsync2 = _interopRequireDefault(_wrapAsync);\n\nvar _awaitify = require('./internal/awaitify.js');\n\nvar _awaitify2 = _interopRequireDefault(_awaitify);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Runs the `tasks` array of functions in series, each passing their results to\n * the next in the array. However, if any of the `tasks` pass an error to their\n * own callback, the next function is not executed, and the main `callback` is\n * immediately called with the error.\n *\n * @name waterfall\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @category Control Flow\n * @param {Array} tasks - An array of [async functions]{@link AsyncFunction}\n * to run.\n * Each function should complete with any number of `result` values.\n * The `result` values will be passed as arguments, in order, to the next task.\n * @param {Function} [callback] - An optional callback to run once all the\n * functions have completed. This will be passed the results of the last task's\n * callback. Invoked with (err, [results]).\n * @returns {Promise} a promise, if a callback is omitted\n * @example\n *\n * async.waterfall([\n *     function(callback) {\n *         callback(null, 'one', 'two');\n *     },\n *     function(arg1, arg2, callback) {\n *         // arg1 now equals 'one' and arg2 now equals 'two'\n *         callback(null, 'three');\n *     },\n *     function(arg1, callback) {\n *         // arg1 now equals 'three'\n *         callback(null, 'done');\n *     }\n * ], function (err, result) {\n *     // result now equals 'done'\n * });\n *\n * // Or, with named functions:\n * async.waterfall([\n *     myFirstFunction,\n *     mySecondFunction,\n *     myLastFunction,\n * ], function (err, result) {\n *     // result now equals 'done'\n * });\n * function myFirstFunction(callback) {\n *     callback(null, 'one', 'two');\n * }\n * function mySecondFunction(arg1, arg2, callback) {\n *     // arg1 now equals 'one' and arg2 now equals 'two'\n *     callback(null, 'three');\n * }\n * function myLastFunction(arg1, callback) {\n *     // arg1 now equals 'three'\n *     callback(null, 'done');\n * }\n */\nfunction waterfall(tasks, callback) {\n    callback = (0, _once2.default)(callback);\n    if (!Array.isArray(tasks)) return callback(new Error('First argument to waterfall must be an array of functions'));\n    if (!tasks.length) return callback();\n    var taskIndex = 0;\n\n    function nextTask(args) {\n        var task = (0, _wrapAsync2.default)(tasks[taskIndex++]);\n        task(...args, (0, _onlyOnce2.default)(next));\n    }\n\n    function next(err, ...args) {\n        if (err === false) return;\n        if (err || taskIndex === tasks.length) {\n            return callback(err, ...args);\n        }\n        nextTask(args);\n    }\n\n    nextTask([]);\n}\n\nexports.default = (0, _awaitify2.default)(waterfall);\nmodule.exports = exports['default'];"]}