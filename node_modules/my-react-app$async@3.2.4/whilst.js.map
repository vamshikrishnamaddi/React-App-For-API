{"version":3,"sources":["whilst.js"],"names":["Object","defineProperty","exports","value","_onlyOnce","require","_onlyOnce2","_interopRequireDefault","_wrapAsync","_wrapAsync2","_awaitify","_awaitify2","obj","__esModule","default","whilst","test","iteratee","callback","_fn","_test","results","next","err","rest","check","truth","module"],"mappings":"AAAA;;;;;;AAEAA,eAAOC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AACzCC,mBAAO;AADkC,SAA7C;;AAIA,YAAIC,YAAYC,QAAQ,qBAAR,CAAhB;;AAEA,YAAIC,aAAaC,uBAAuBH,SAAvB,CAAjB;;AAEA,YAAII,aAAaH,QAAQ,sBAAR,CAAjB;;AAEA,YAAII,cAAcF,uBAAuBC,UAAvB,CAAlB;;AAEA,YAAIE,YAAYL,QAAQ,qBAAR,CAAhB;;AAEA,YAAIM,aAAaJ,uBAAuBG,SAAvB,CAAjB;;AAEA,iBAASH,sBAAT,CAAgCK,GAAhC,EAAqC;AAAE,mBAAOA,OAAOA,IAAIC,UAAX,GAAwBD,GAAxB,GAA8B,EAAEE,SAASF,GAAX,EAArC;AAAwD;;AAE/F;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkCA,iBAASG,MAAT,CAAgBC,IAAhB,EAAsBC,QAAtB,EAAgCC,QAAhC,EAA0C;AACtCA,uBAAW,CAAC,GAAGZ,WAAWQ,OAAf,EAAwBI,QAAxB,CAAX;AACA,gBAAIC,MAAM,CAAC,GAAGV,YAAYK,OAAhB,EAAyBG,QAAzB,CAAV;AACA,gBAAIG,QAAQ,CAAC,GAAGX,YAAYK,OAAhB,EAAyBE,IAAzB,CAAZ;AACA,gBAAIK,UAAU,EAAd;;AAEA,qBAASC,IAAT,CAAcC,GAAd,EAAmB,GAAGC,IAAtB,EAA4B;AACxB,oBAAID,GAAJ,EAAS,OAAOL,SAASK,GAAT,CAAP;AACTF,0BAAUG,IAAV;AACA,oBAAID,QAAQ,KAAZ,EAAmB;AACnBH,sBAAMK,KAAN;AACH;;AAED,qBAASA,KAAT,CAAeF,GAAf,EAAoBG,KAApB,EAA2B;AACvB,oBAAIH,GAAJ,EAAS,OAAOL,SAASK,GAAT,CAAP;AACT,oBAAIA,QAAQ,KAAZ,EAAmB;AACnB,oBAAI,CAACG,KAAL,EAAY,OAAOR,SAAS,IAAT,EAAe,GAAGG,OAAlB,CAAP;AACZF,oBAAIG,IAAJ;AACH;;AAED,mBAAOF,MAAMK,KAAN,CAAP;AACH;AACDvB,gBAAQY,OAAR,GAAkB,CAAC,GAAGH,WAAWG,OAAf,EAAwBC,MAAxB,EAAgC,CAAhC,CAAlB;AACAY,eAAOzB,OAAP,GAAiBA,QAAQ,SAAR,CAAjB","file":"whilst.js","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _onlyOnce = require('./internal/onlyOnce.js');\n\nvar _onlyOnce2 = _interopRequireDefault(_onlyOnce);\n\nvar _wrapAsync = require('./internal/wrapAsync.js');\n\nvar _wrapAsync2 = _interopRequireDefault(_wrapAsync);\n\nvar _awaitify = require('./internal/awaitify.js');\n\nvar _awaitify2 = _interopRequireDefault(_awaitify);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Repeatedly call `iteratee`, while `test` returns `true`. Calls `callback` when\n * stopped, or an error occurs.\n *\n * @name whilst\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @category Control Flow\n * @param {AsyncFunction} test - asynchronous truth test to perform before each\n * execution of `iteratee`. Invoked with ().\n * @param {AsyncFunction} iteratee - An async function which is called each time\n * `test` passes. Invoked with (callback).\n * @param {Function} [callback] - A callback which is called after the test\n * function has failed and repeated execution of `iteratee` has stopped. `callback`\n * will be passed an error and any arguments passed to the final `iteratee`'s\n * callback. Invoked with (err, [results]);\n * @returns {Promise} a promise, if no callback is passed\n * @example\n *\n * var count = 0;\n * async.whilst(\n *     function test(cb) { cb(null, count < 5); },\n *     function iter(callback) {\n *         count++;\n *         setTimeout(function() {\n *             callback(null, count);\n *         }, 1000);\n *     },\n *     function (err, n) {\n *         // 5 seconds have passed, n = 5\n *     }\n * );\n */\nfunction whilst(test, iteratee, callback) {\n    callback = (0, _onlyOnce2.default)(callback);\n    var _fn = (0, _wrapAsync2.default)(iteratee);\n    var _test = (0, _wrapAsync2.default)(test);\n    var results = [];\n\n    function next(err, ...rest) {\n        if (err) return callback(err);\n        results = rest;\n        if (err === false) return;\n        _test(check);\n    }\n\n    function check(err, truth) {\n        if (err) return callback(err);\n        if (err === false) return;\n        if (!truth) return callback(null, ...results);\n        _fn(next);\n    }\n\n    return _test(check);\n}\nexports.default = (0, _awaitify2.default)(whilst, 3);\nmodule.exports = exports['default'];"]}