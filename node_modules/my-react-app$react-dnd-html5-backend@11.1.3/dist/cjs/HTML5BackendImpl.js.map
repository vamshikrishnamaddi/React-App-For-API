{"version":3,"sources":["HTML5BackendImpl.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","Object","defineProperty","exports","value","HTML5BackendImpl","_EnterLeaveCounter","require","_BrowserDetector","_OffsetUtils","_NativeDragSources","NativeTypes","_interopRequireWildcard","_OptionsReader","_getRequireWildcardCache","WeakMap","cache","__esModule","default","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","hasOwnProperty","call","desc","set","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","configurable","writable","_classCallCheck","instance","Constructor","TypeError","_defineProperties","props","descriptor","_createClass","protoProps","staticProps","manager","globalContext","_this","sourcePreviewNodes","Map","sourcePreviewNodeOptions","sourceNodes","sourceNodeOptions","dragStartSourceIds","dropTargetIds","dragEnterTargetIds","currentNativeSource","currentNativeHandle","currentDragSourceNode","altKeyPressed","mouseMoveTimeoutTimer","asyncEndDragFrameId","dragOverTargetIds","getSourceClientOffset","sourceId","getNodeClientOffset","endDragNativeItem","isDraggingNativeItem","actions","endDrag","registry","removeSource","isNodeInDocument","node","Boolean","document","body","contains","endDragIfSourceWasRemovedFromDOM","clearCurrentDragSourceNode","handleTopDragStartCapture","handleTopDragStart","e","defaultPrevented","clientOffset","getEventClientOffset","monitor","isDragging","beginDrag","publishSource","dataTransfer","nativeType","matchNativeItemType","setDragImage","getSourceId","sourceNode","dragPreview","_this$getCurrentSourc","getCurrentSourcePreviewNodeOptions","anchorX","anchorY","offsetX","offsetY","dragPreviewOffset","getDragPreviewOffset","x","y","setData","err","setCurrentDragSourceNode","_this$getCurrentSourc2","captureDraggingState","setTimeout","publishDragSource","beginDragNativeItem","types","hasAttribute","preventDefault","handleTopDragEndCapture","handleTopDragEnterCapture","isFirstEnter","enterLeaveCounter","enter","handleTopDragEnter","altKey","isFirefox","hover","canDrop","some","targetId","canDropOnTarget","dropEffect","getCurrentDropEffect","handleTopDragOverCapture","handleTopDragOver","handleTopDragLeaveCapture","isLastLeave","leave","handleTopDropCapture","_this$currentNativeSo","loadDataTransfer","reset","handleTopDrop","drop","handleSelectStart","dragDrop","tagName","isContentEditable","options","OptionsReader","getActions","getMonitor","getRegistry","EnterLeaveCounter","profile","_this$dragStartSource","_this$dragOverTargetI","size","setup","window","undefined","__isReactDndBackendSetUp","Error","addEventListeners","teardown","removeEventListeners","cancelAnimationFrame","connectDragPreview","_this2","delete","connectDragSource","_this3","handleDragStart","setAttribute","addEventListener","removeEventListener","connectDropTarget","_this4","handleDragEnter","handleDragOver","handleDrop","getCurrentSourceNodeOptions","itemType","getItemType","type","createNativeDragSource","addSource","_this5","clearTimeout","unshift"],"mappings":"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","file":"HTML5BackendImpl.js","sourcesContent":["\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.HTML5BackendImpl = void 0;\n\nvar _EnterLeaveCounter = require(\"./EnterLeaveCounter\");\n\nvar _BrowserDetector = require(\"./BrowserDetector\");\n\nvar _OffsetUtils = require(\"./OffsetUtils\");\n\nvar _NativeDragSources = require(\"./NativeDragSources\");\n\nvar NativeTypes = _interopRequireWildcard(require(\"./NativeTypes\"));\n\nvar _OptionsReader = require(\"./OptionsReader\");\n\nfunction _getRequireWildcardCache() { if (typeof WeakMap !== \"function\") return null; var cache = new WeakMap(); _getRequireWildcardCache = function _getRequireWildcardCache() { return cache; }; return cache; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar HTML5BackendImpl = /*#__PURE__*/function () {\n  function HTML5BackendImpl(manager, globalContext) {\n    var _this = this;\n\n    _classCallCheck(this, HTML5BackendImpl);\n\n    this.sourcePreviewNodes = new Map();\n    this.sourcePreviewNodeOptions = new Map();\n    this.sourceNodes = new Map();\n    this.sourceNodeOptions = new Map();\n    this.dragStartSourceIds = null;\n    this.dropTargetIds = [];\n    this.dragEnterTargetIds = [];\n    this.currentNativeSource = null;\n    this.currentNativeHandle = null;\n    this.currentDragSourceNode = null;\n    this.altKeyPressed = false;\n    this.mouseMoveTimeoutTimer = null;\n    this.asyncEndDragFrameId = null;\n    this.dragOverTargetIds = null;\n\n    this.getSourceClientOffset = function (sourceId) {\n      var source = _this.sourceNodes.get(sourceId);\n\n      return source && (0, _OffsetUtils.getNodeClientOffset)(source) || null;\n    };\n\n    this.endDragNativeItem = function () {\n      if (!_this.isDraggingNativeItem()) {\n        return;\n      }\n\n      _this.actions.endDrag();\n\n      if (_this.currentNativeHandle) {\n        _this.registry.removeSource(_this.currentNativeHandle);\n      }\n\n      _this.currentNativeHandle = null;\n      _this.currentNativeSource = null;\n    };\n\n    this.isNodeInDocument = function (node) {\n      // Check the node either in the main document or in the current context\n      return Boolean(node && _this.document && _this.document.body && document.body.contains(node));\n    };\n\n    this.endDragIfSourceWasRemovedFromDOM = function () {\n      var node = _this.currentDragSourceNode;\n\n      if (_this.isNodeInDocument(node)) {\n        return;\n      }\n\n      if (_this.clearCurrentDragSourceNode()) {\n        _this.actions.endDrag();\n      }\n    };\n\n    this.handleTopDragStartCapture = function () {\n      _this.clearCurrentDragSourceNode();\n\n      _this.dragStartSourceIds = [];\n    };\n\n    this.handleTopDragStart = function (e) {\n      if (e.defaultPrevented) {\n        return;\n      }\n\n      var dragStartSourceIds = _this.dragStartSourceIds;\n      _this.dragStartSourceIds = null;\n      var clientOffset = (0, _OffsetUtils.getEventClientOffset)(e); // Avoid crashing if we missed a drop event or our previous drag died\n\n      if (_this.monitor.isDragging()) {\n        _this.actions.endDrag();\n      } // Don't publish the source just yet (see why below)\n\n\n      _this.actions.beginDrag(dragStartSourceIds || [], {\n        publishSource: false,\n        getSourceClientOffset: _this.getSourceClientOffset,\n        clientOffset: clientOffset\n      });\n\n      var dataTransfer = e.dataTransfer;\n      var nativeType = (0, _NativeDragSources.matchNativeItemType)(dataTransfer);\n\n      if (_this.monitor.isDragging()) {\n        if (dataTransfer && typeof dataTransfer.setDragImage === 'function') {\n          // Use custom drag image if user specifies it.\n          // If child drag source refuses drag but parent agrees,\n          // use parent's node as drag image. Neither works in IE though.\n          var sourceId = _this.monitor.getSourceId();\n\n          var sourceNode = _this.sourceNodes.get(sourceId);\n\n          var dragPreview = _this.sourcePreviewNodes.get(sourceId) || sourceNode;\n\n          if (dragPreview) {\n            var _this$getCurrentSourc = _this.getCurrentSourcePreviewNodeOptions(),\n                anchorX = _this$getCurrentSourc.anchorX,\n                anchorY = _this$getCurrentSourc.anchorY,\n                offsetX = _this$getCurrentSourc.offsetX,\n                offsetY = _this$getCurrentSourc.offsetY;\n\n            var anchorPoint = {\n              anchorX: anchorX,\n              anchorY: anchorY\n            };\n            var offsetPoint = {\n              offsetX: offsetX,\n              offsetY: offsetY\n            };\n            var dragPreviewOffset = (0, _OffsetUtils.getDragPreviewOffset)(sourceNode, dragPreview, clientOffset, anchorPoint, offsetPoint);\n            dataTransfer.setDragImage(dragPreview, dragPreviewOffset.x, dragPreviewOffset.y);\n          }\n        }\n\n        try {\n          // Firefox won't drag without setting data\n          dataTransfer === null || dataTransfer === void 0 ? void 0 : dataTransfer.setData('application/json', {});\n        } catch (err) {} // IE doesn't support MIME types in setData\n        // Store drag source node so we can check whether\n        // it is removed from DOM and trigger endDrag manually.\n\n\n        _this.setCurrentDragSourceNode(e.target); // Now we are ready to publish the drag source.. or are we not?\n\n\n        var _this$getCurrentSourc2 = _this.getCurrentSourcePreviewNodeOptions(),\n            captureDraggingState = _this$getCurrentSourc2.captureDraggingState;\n\n        if (!captureDraggingState) {\n          // Usually we want to publish it in the next tick so that browser\n          // is able to screenshot the current (not yet dragging) state.\n          //\n          // It also neatly avoids a situation where render() returns null\n          // in the same tick for the source element, and browser freaks out.\n          setTimeout(function () {\n            return _this.actions.publishDragSource();\n          }, 0);\n        } else {\n          // In some cases the user may want to override this behavior, e.g.\n          // to work around IE not supporting custom drag previews.\n          //\n          // When using a custom drag layer, the only way to prevent\n          // the default drag preview from drawing in IE is to screenshot\n          // the dragging state in which the node itself has zero opacity\n          // and height. In this case, though, returning null from render()\n          // will abruptly end the dragging, which is not obvious.\n          //\n          // This is the reason such behavior is strictly opt-in.\n          _this.actions.publishDragSource();\n        }\n      } else if (nativeType) {\n        // A native item (such as URL) dragged from inside the document\n        _this.beginDragNativeItem(nativeType);\n      } else if (dataTransfer && !dataTransfer.types && (e.target && !e.target.hasAttribute || !e.target.hasAttribute('draggable'))) {\n        // Looks like a Safari bug: dataTransfer.types is null, but there was no draggable.\n        // Just let it drag. It's a native type (URL or text) and will be picked up in\n        // dragenter handler.\n        return;\n      } else {\n        // If by this time no drag source reacted, tell browser not to drag.\n        e.preventDefault();\n      }\n    };\n\n    this.handleTopDragEndCapture = function () {\n      if (_this.clearCurrentDragSourceNode()) {\n        // Firefox can dispatch this event in an infinite loop\n        // if dragend handler does something like showing an alert.\n        // Only proceed if we have not handled it already.\n        _this.actions.endDrag();\n      }\n    };\n\n    this.handleTopDragEnterCapture = function (e) {\n      _this.dragEnterTargetIds = [];\n\n      var isFirstEnter = _this.enterLeaveCounter.enter(e.target);\n\n      if (!isFirstEnter || _this.monitor.isDragging()) {\n        return;\n      }\n\n      var dataTransfer = e.dataTransfer;\n      var nativeType = (0, _NativeDragSources.matchNativeItemType)(dataTransfer);\n\n      if (nativeType) {\n        // A native item (such as file or URL) dragged from outside the document\n        _this.beginDragNativeItem(nativeType, dataTransfer);\n      }\n    };\n\n    this.handleTopDragEnter = function (e) {\n      var dragEnterTargetIds = _this.dragEnterTargetIds;\n      _this.dragEnterTargetIds = [];\n\n      if (!_this.monitor.isDragging()) {\n        // This is probably a native item type we don't understand.\n        return;\n      }\n\n      _this.altKeyPressed = e.altKey;\n\n      if (!(0, _BrowserDetector.isFirefox)()) {\n        // Don't emit hover in `dragenter` on Firefox due to an edge case.\n        // If the target changes position as the result of `dragenter`, Firefox\n        // will still happily dispatch `dragover` despite target being no longer\n        // there. The easy solution is to only fire `hover` in `dragover` on FF.\n        _this.actions.hover(dragEnterTargetIds, {\n          clientOffset: (0, _OffsetUtils.getEventClientOffset)(e)\n        });\n      }\n\n      var canDrop = dragEnterTargetIds.some(function (targetId) {\n        return _this.monitor.canDropOnTarget(targetId);\n      });\n\n      if (canDrop) {\n        // IE requires this to fire dragover events\n        e.preventDefault();\n\n        if (e.dataTransfer) {\n          e.dataTransfer.dropEffect = _this.getCurrentDropEffect();\n        }\n      }\n    };\n\n    this.handleTopDragOverCapture = function () {\n      _this.dragOverTargetIds = [];\n    };\n\n    this.handleTopDragOver = function (e) {\n      var dragOverTargetIds = _this.dragOverTargetIds;\n      _this.dragOverTargetIds = [];\n\n      if (!_this.monitor.isDragging()) {\n        // This is probably a native item type we don't understand.\n        // Prevent default \"drop and blow away the whole document\" action.\n        e.preventDefault();\n\n        if (e.dataTransfer) {\n          e.dataTransfer.dropEffect = 'none';\n        }\n\n        return;\n      }\n\n      _this.altKeyPressed = e.altKey;\n\n      _this.actions.hover(dragOverTargetIds || [], {\n        clientOffset: (0, _OffsetUtils.getEventClientOffset)(e)\n      });\n\n      var canDrop = (dragOverTargetIds || []).some(function (targetId) {\n        return _this.monitor.canDropOnTarget(targetId);\n      });\n\n      if (canDrop) {\n        // Show user-specified drop effect.\n        e.preventDefault();\n\n        if (e.dataTransfer) {\n          e.dataTransfer.dropEffect = _this.getCurrentDropEffect();\n        }\n      } else if (_this.isDraggingNativeItem()) {\n        // Don't show a nice cursor but still prevent default\n        // \"drop and blow away the whole document\" action.\n        e.preventDefault();\n      } else {\n        e.preventDefault();\n\n        if (e.dataTransfer) {\n          e.dataTransfer.dropEffect = 'none';\n        }\n      }\n    };\n\n    this.handleTopDragLeaveCapture = function (e) {\n      if (_this.isDraggingNativeItem()) {\n        e.preventDefault();\n      }\n\n      var isLastLeave = _this.enterLeaveCounter.leave(e.target);\n\n      if (!isLastLeave) {\n        return;\n      }\n\n      if (_this.isDraggingNativeItem()) {\n        _this.endDragNativeItem();\n      }\n    };\n\n    this.handleTopDropCapture = function (e) {\n      _this.dropTargetIds = [];\n      e.preventDefault();\n\n      if (_this.isDraggingNativeItem()) {\n        var _this$currentNativeSo;\n\n        (_this$currentNativeSo = _this.currentNativeSource) === null || _this$currentNativeSo === void 0 ? void 0 : _this$currentNativeSo.loadDataTransfer(e.dataTransfer);\n      }\n\n      _this.enterLeaveCounter.reset();\n    };\n\n    this.handleTopDrop = function (e) {\n      var dropTargetIds = _this.dropTargetIds;\n      _this.dropTargetIds = [];\n\n      _this.actions.hover(dropTargetIds, {\n        clientOffset: (0, _OffsetUtils.getEventClientOffset)(e)\n      });\n\n      _this.actions.drop({\n        dropEffect: _this.getCurrentDropEffect()\n      });\n\n      if (_this.isDraggingNativeItem()) {\n        _this.endDragNativeItem();\n      } else {\n        _this.endDragIfSourceWasRemovedFromDOM();\n      }\n    };\n\n    this.handleSelectStart = function (e) {\n      var target = e.target; // Only IE requires us to explicitly say\n      // we want drag drop operation to start\n\n      if (typeof target.dragDrop !== 'function') {\n        return;\n      } // Inputs and textareas should be selectable\n\n\n      if (target.tagName === 'INPUT' || target.tagName === 'SELECT' || target.tagName === 'TEXTAREA' || target.isContentEditable) {\n        return;\n      } // For other targets, ask IE\n      // to enable drag and drop\n\n\n      e.preventDefault();\n      target.dragDrop();\n    };\n\n    this.options = new _OptionsReader.OptionsReader(globalContext);\n    this.actions = manager.getActions();\n    this.monitor = manager.getMonitor();\n    this.registry = manager.getRegistry();\n    this.enterLeaveCounter = new _EnterLeaveCounter.EnterLeaveCounter(this.isNodeInDocument);\n  }\n  /**\n   * Generate profiling statistics for the HTML5Backend.\n   */\n\n\n  _createClass(HTML5BackendImpl, [{\n    key: \"profile\",\n    value: function profile() {\n      var _this$dragStartSource, _this$dragOverTargetI;\n\n      return {\n        sourcePreviewNodes: this.sourcePreviewNodes.size,\n        sourcePreviewNodeOptions: this.sourcePreviewNodeOptions.size,\n        sourceNodeOptions: this.sourceNodeOptions.size,\n        sourceNodes: this.sourceNodes.size,\n        dragStartSourceIds: ((_this$dragStartSource = this.dragStartSourceIds) === null || _this$dragStartSource === void 0 ? void 0 : _this$dragStartSource.length) || 0,\n        dropTargetIds: this.dropTargetIds.length,\n        dragEnterTargetIds: this.dragEnterTargetIds.length,\n        dragOverTargetIds: ((_this$dragOverTargetI = this.dragOverTargetIds) === null || _this$dragOverTargetI === void 0 ? void 0 : _this$dragOverTargetI.length) || 0\n      };\n    } // public for test\n\n  }, {\n    key: \"setup\",\n    value: function setup() {\n      if (this.window === undefined) {\n        return;\n      }\n\n      if (this.window.__isReactDndBackendSetUp) {\n        throw new Error('Cannot have two HTML5 backends at the same time.');\n      }\n\n      this.window.__isReactDndBackendSetUp = true;\n      this.addEventListeners(this.window);\n    }\n  }, {\n    key: \"teardown\",\n    value: function teardown() {\n      if (this.window === undefined) {\n        return;\n      }\n\n      this.window.__isReactDndBackendSetUp = false;\n      this.removeEventListeners(this.window);\n      this.clearCurrentDragSourceNode();\n\n      if (this.asyncEndDragFrameId) {\n        this.window.cancelAnimationFrame(this.asyncEndDragFrameId);\n      }\n    }\n  }, {\n    key: \"connectDragPreview\",\n    value: function connectDragPreview(sourceId, node, options) {\n      var _this2 = this;\n\n      this.sourcePreviewNodeOptions.set(sourceId, options);\n      this.sourcePreviewNodes.set(sourceId, node);\n      return function () {\n        _this2.sourcePreviewNodes.delete(sourceId);\n\n        _this2.sourcePreviewNodeOptions.delete(sourceId);\n      };\n    }\n  }, {\n    key: \"connectDragSource\",\n    value: function connectDragSource(sourceId, node, options) {\n      var _this3 = this;\n\n      this.sourceNodes.set(sourceId, node);\n      this.sourceNodeOptions.set(sourceId, options);\n\n      var handleDragStart = function handleDragStart(e) {\n        return _this3.handleDragStart(e, sourceId);\n      };\n\n      var handleSelectStart = function handleSelectStart(e) {\n        return _this3.handleSelectStart(e);\n      };\n\n      node.setAttribute('draggable', 'true');\n      node.addEventListener('dragstart', handleDragStart);\n      node.addEventListener('selectstart', handleSelectStart);\n      return function () {\n        _this3.sourceNodes.delete(sourceId);\n\n        _this3.sourceNodeOptions.delete(sourceId);\n\n        node.removeEventListener('dragstart', handleDragStart);\n        node.removeEventListener('selectstart', handleSelectStart);\n        node.setAttribute('draggable', 'false');\n      };\n    }\n  }, {\n    key: \"connectDropTarget\",\n    value: function connectDropTarget(targetId, node) {\n      var _this4 = this;\n\n      var handleDragEnter = function handleDragEnter(e) {\n        return _this4.handleDragEnter(e, targetId);\n      };\n\n      var handleDragOver = function handleDragOver(e) {\n        return _this4.handleDragOver(e, targetId);\n      };\n\n      var handleDrop = function handleDrop(e) {\n        return _this4.handleDrop(e, targetId);\n      };\n\n      node.addEventListener('dragenter', handleDragEnter);\n      node.addEventListener('dragover', handleDragOver);\n      node.addEventListener('drop', handleDrop);\n      return function () {\n        node.removeEventListener('dragenter', handleDragEnter);\n        node.removeEventListener('dragover', handleDragOver);\n        node.removeEventListener('drop', handleDrop);\n      };\n    }\n  }, {\n    key: \"addEventListeners\",\n    value: function addEventListeners(target) {\n      // SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n      if (!target.addEventListener) {\n        return;\n      }\n\n      target.addEventListener('dragstart', this.handleTopDragStart);\n      target.addEventListener('dragstart', this.handleTopDragStartCapture, true);\n      target.addEventListener('dragend', this.handleTopDragEndCapture, true);\n      target.addEventListener('dragenter', this.handleTopDragEnter);\n      target.addEventListener('dragenter', this.handleTopDragEnterCapture, true);\n      target.addEventListener('dragleave', this.handleTopDragLeaveCapture, true);\n      target.addEventListener('dragover', this.handleTopDragOver);\n      target.addEventListener('dragover', this.handleTopDragOverCapture, true);\n      target.addEventListener('drop', this.handleTopDrop);\n      target.addEventListener('drop', this.handleTopDropCapture, true);\n    }\n  }, {\n    key: \"removeEventListeners\",\n    value: function removeEventListeners(target) {\n      // SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n      if (!target.removeEventListener) {\n        return;\n      }\n\n      target.removeEventListener('dragstart', this.handleTopDragStart);\n      target.removeEventListener('dragstart', this.handleTopDragStartCapture, true);\n      target.removeEventListener('dragend', this.handleTopDragEndCapture, true);\n      target.removeEventListener('dragenter', this.handleTopDragEnter);\n      target.removeEventListener('dragenter', this.handleTopDragEnterCapture, true);\n      target.removeEventListener('dragleave', this.handleTopDragLeaveCapture, true);\n      target.removeEventListener('dragover', this.handleTopDragOver);\n      target.removeEventListener('dragover', this.handleTopDragOverCapture, true);\n      target.removeEventListener('drop', this.handleTopDrop);\n      target.removeEventListener('drop', this.handleTopDropCapture, true);\n    }\n  }, {\n    key: \"getCurrentSourceNodeOptions\",\n    value: function getCurrentSourceNodeOptions() {\n      var sourceId = this.monitor.getSourceId();\n      var sourceNodeOptions = this.sourceNodeOptions.get(sourceId);\n      return _objectSpread({\n        dropEffect: this.altKeyPressed ? 'copy' : 'move'\n      }, sourceNodeOptions || {});\n    }\n  }, {\n    key: \"getCurrentDropEffect\",\n    value: function getCurrentDropEffect() {\n      if (this.isDraggingNativeItem()) {\n        // It makes more sense to default to 'copy' for native resources\n        return 'copy';\n      }\n\n      return this.getCurrentSourceNodeOptions().dropEffect;\n    }\n  }, {\n    key: \"getCurrentSourcePreviewNodeOptions\",\n    value: function getCurrentSourcePreviewNodeOptions() {\n      var sourceId = this.monitor.getSourceId();\n      var sourcePreviewNodeOptions = this.sourcePreviewNodeOptions.get(sourceId);\n      return _objectSpread({\n        anchorX: 0.5,\n        anchorY: 0.5,\n        captureDraggingState: false\n      }, sourcePreviewNodeOptions || {});\n    }\n  }, {\n    key: \"isDraggingNativeItem\",\n    value: function isDraggingNativeItem() {\n      var itemType = this.monitor.getItemType();\n      return Object.keys(NativeTypes).some(function (key) {\n        return NativeTypes[key] === itemType;\n      });\n    }\n  }, {\n    key: \"beginDragNativeItem\",\n    value: function beginDragNativeItem(type, dataTransfer) {\n      this.clearCurrentDragSourceNode();\n      this.currentNativeSource = (0, _NativeDragSources.createNativeDragSource)(type, dataTransfer);\n      this.currentNativeHandle = this.registry.addSource(type, this.currentNativeSource);\n      this.actions.beginDrag([this.currentNativeHandle]);\n    }\n  }, {\n    key: \"setCurrentDragSourceNode\",\n    value: function setCurrentDragSourceNode(node) {\n      var _this5 = this;\n\n      this.clearCurrentDragSourceNode();\n      this.currentDragSourceNode = node; // A timeout of > 0 is necessary to resolve Firefox issue referenced\n      // See:\n      //   * https://github.com/react-dnd/react-dnd/pull/928\n      //   * https://github.com/react-dnd/react-dnd/issues/869\n\n      var MOUSE_MOVE_TIMEOUT = 1000; // Receiving a mouse event in the middle of a dragging operation\n      // means it has ended and the drag source node disappeared from DOM,\n      // so the browser didn't dispatch the dragend event.\n      //\n      // We need to wait before we start listening for mousemove events.\n      // This is needed because the drag preview needs to be drawn or else it fires an 'mousemove' event\n      // immediately in some browsers.\n      //\n      // See:\n      //   * https://github.com/react-dnd/react-dnd/pull/928\n      //   * https://github.com/react-dnd/react-dnd/issues/869\n      //\n\n      this.mouseMoveTimeoutTimer = setTimeout(function () {\n        return _this5.window && _this5.window.addEventListener('mousemove', _this5.endDragIfSourceWasRemovedFromDOM, true);\n      }, MOUSE_MOVE_TIMEOUT);\n    }\n  }, {\n    key: \"clearCurrentDragSourceNode\",\n    value: function clearCurrentDragSourceNode() {\n      if (this.currentDragSourceNode) {\n        this.currentDragSourceNode = null;\n\n        if (this.window) {\n          this.window.clearTimeout(this.mouseMoveTimeoutTimer || undefined);\n          this.window.removeEventListener('mousemove', this.endDragIfSourceWasRemovedFromDOM, true);\n        }\n\n        this.mouseMoveTimeoutTimer = null;\n        return true;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"handleDragStart\",\n    value: function handleDragStart(e, sourceId) {\n      if (e.defaultPrevented) {\n        return;\n      }\n\n      if (!this.dragStartSourceIds) {\n        this.dragStartSourceIds = [];\n      }\n\n      this.dragStartSourceIds.unshift(sourceId);\n    }\n  }, {\n    key: \"handleDragEnter\",\n    value: function handleDragEnter(e, targetId) {\n      this.dragEnterTargetIds.unshift(targetId);\n    }\n  }, {\n    key: \"handleDragOver\",\n    value: function handleDragOver(e, targetId) {\n      if (this.dragOverTargetIds === null) {\n        this.dragOverTargetIds = [];\n      }\n\n      this.dragOverTargetIds.unshift(targetId);\n    }\n  }, {\n    key: \"handleDrop\",\n    value: function handleDrop(e, targetId) {\n      this.dropTargetIds.unshift(targetId);\n    }\n  }, {\n    key: \"window\",\n    get: function get() {\n      return this.options.window;\n    }\n  }, {\n    key: \"document\",\n    get: function get() {\n      return this.options.document;\n    }\n  }]);\n\n  return HTML5BackendImpl;\n}();\n\nexports.HTML5BackendImpl = HTML5BackendImpl;"]}