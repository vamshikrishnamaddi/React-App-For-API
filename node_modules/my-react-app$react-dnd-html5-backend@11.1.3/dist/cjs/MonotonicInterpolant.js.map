{"version":3,"sources":["MonotonicInterpolant.js"],"names":["Object","defineProperty","exports","value","MonotonicInterpolant","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","_createClass","protoProps","staticProps","prototype","xs","ys","indexes","push","sort","a","b","dys","dxs","ms","dx","dy","_i","c1s","_i2","m2","mNext","dxNext","common","c2s","c3s","m","_i3","c1","invDx","_common","interpolate","x","low","high","mid","Math","floor","xHere","max","diff","diffSq"],"mappings":"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","file":"MonotonicInterpolant.js","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.MonotonicInterpolant = void 0;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar MonotonicInterpolant = /*#__PURE__*/function () {\n  function MonotonicInterpolant(xs, ys) {\n    _classCallCheck(this, MonotonicInterpolant);\n\n    var length = xs.length; // Rearrange xs and ys so that xs is sorted\n\n    var indexes = [];\n\n    for (var i = 0; i < length; i++) {\n      indexes.push(i);\n    }\n\n    indexes.sort(function (a, b) {\n      return xs[a] < xs[b] ? -1 : 1;\n    }); // Get consecutive differences and slopes\n\n    var dys = [];\n    var dxs = [];\n    var ms = [];\n    var dx;\n    var dy;\n\n    for (var _i = 0; _i < length - 1; _i++) {\n      dx = xs[_i + 1] - xs[_i];\n      dy = ys[_i + 1] - ys[_i];\n      dxs.push(dx);\n      dys.push(dy);\n      ms.push(dy / dx);\n    } // Get degree-1 coefficients\n\n\n    var c1s = [ms[0]];\n\n    for (var _i2 = 0; _i2 < dxs.length - 1; _i2++) {\n      var m2 = ms[_i2];\n      var mNext = ms[_i2 + 1];\n\n      if (m2 * mNext <= 0) {\n        c1s.push(0);\n      } else {\n        dx = dxs[_i2];\n        var dxNext = dxs[_i2 + 1];\n        var common = dx + dxNext;\n        c1s.push(3 * common / ((common + dxNext) / m2 + (common + dx) / mNext));\n      }\n    }\n\n    c1s.push(ms[ms.length - 1]); // Get degree-2 and degree-3 coefficients\n\n    var c2s = [];\n    var c3s = [];\n    var m;\n\n    for (var _i3 = 0; _i3 < c1s.length - 1; _i3++) {\n      m = ms[_i3];\n      var c1 = c1s[_i3];\n      var invDx = 1 / dxs[_i3];\n\n      var _common = c1 + c1s[_i3 + 1] - m - m;\n\n      c2s.push((m - c1 - _common) * invDx);\n      c3s.push(_common * invDx * invDx);\n    }\n\n    this.xs = xs;\n    this.ys = ys;\n    this.c1s = c1s;\n    this.c2s = c2s;\n    this.c3s = c3s;\n  }\n\n  _createClass(MonotonicInterpolant, [{\n    key: \"interpolate\",\n    value: function interpolate(x) {\n      var xs = this.xs,\n          ys = this.ys,\n          c1s = this.c1s,\n          c2s = this.c2s,\n          c3s = this.c3s; // The rightmost point in the dataset should give an exact result\n\n      var i = xs.length - 1;\n\n      if (x === xs[i]) {\n        return ys[i];\n      } // Search for the interval x is in, returning the corresponding y if x is one of the original xs\n\n\n      var low = 0;\n      var high = c3s.length - 1;\n      var mid;\n\n      while (low <= high) {\n        mid = Math.floor(0.5 * (low + high));\n        var xHere = xs[mid];\n\n        if (xHere < x) {\n          low = mid + 1;\n        } else if (xHere > x) {\n          high = mid - 1;\n        } else {\n          return ys[mid];\n        }\n      }\n\n      i = Math.max(0, high); // Interpolate\n\n      var diff = x - xs[i];\n      var diffSq = diff * diff;\n      return ys[i] + c1s[i] * diff + c2s[i] * diffSq + c3s[i] * diff * diffSq;\n    }\n  }]);\n\n  return MonotonicInterpolant;\n}();\n\nexports.MonotonicInterpolant = MonotonicInterpolant;"]}