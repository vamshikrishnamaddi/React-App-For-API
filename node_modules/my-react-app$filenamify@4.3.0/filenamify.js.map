{"version":3,"sources":["filenamify.js"],"names":["trimRepeated","require","filenameReservedRegex","stripOuter","MAX_FILENAME_LENGTH","reControlChars","reRelativePath","reTrailingPeriods","filenamify","string","options","TypeError","replacement","undefined","test","Error","replace","length","windowsNames","slice","maxLength","module","exports"],"mappings":"AAAA;;;;;;AACA,QAAMA,eAAeC,QAAQ,4BAAR,CAArB;AACA,QAAMC,wBAAwBD,QAAQ,sCAAR,CAA9B;AACA,QAAME,aAAaF,QAAQ,0BAAR,CAAnB;;AAEA;AACA,QAAMG,sBAAsB,GAA5B;;AAEA,QAAMC,iBAAiB,+BAAvB,C,CAAwD;AACxD,QAAMC,iBAAiB,MAAvB;AACA,QAAMC,oBAAoB,MAA1B;;AAEA,QAAMC,aAAa,CAACC,MAAD,EAASC,UAAU,EAAnB,KAA0B;AAC5C,OAAI,OAAOD,MAAP,KAAkB,QAAtB,EAAgC;AAC/B,UAAM,IAAIE,SAAJ,CAAc,mBAAd,CAAN;AACA;;AAED,SAAMC,cAAcF,QAAQE,WAAR,KAAwBC,SAAxB,GAAoC,GAApC,GAA0CH,QAAQE,WAAtE;;AAEA,OAAIV,wBAAwBY,IAAxB,CAA6BF,WAA7B,KAA6CP,eAAeS,IAAf,CAAoBF,WAApB,CAAjD,EAAmF;AAClF,UAAM,IAAIG,KAAJ,CAAU,gEAAV,CAAN;AACA;;AAEDN,YAASA,OAAOO,OAAP,CAAed,uBAAf,EAAwCU,WAAxC,CAAT;AACAH,YAASA,OAAOO,OAAP,CAAeX,cAAf,EAA+BO,WAA/B,CAAT;AACAH,YAASA,OAAOO,OAAP,CAAeV,cAAf,EAA+BM,WAA/B,CAAT;AACAH,YAASA,OAAOO,OAAP,CAAeT,iBAAf,EAAkC,EAAlC,CAAT;;AAEA,OAAIK,YAAYK,MAAZ,GAAqB,CAAzB,EAA4B;AAC3BR,aAAST,aAAaS,MAAb,EAAqBG,WAArB,CAAT;AACAH,aAASA,OAAOQ,MAAP,GAAgB,CAAhB,GAAoBd,WAAWM,MAAX,EAAmBG,WAAnB,CAApB,GAAsDH,MAA/D;AACA;;AAEDA,YAASP,sBAAsBgB,YAAtB,GAAqCJ,IAArC,CAA0CL,MAA1C,IAAoDA,SAASG,WAA7D,GAA2EH,MAApF;AACAA,YAASA,OAAOU,KAAP,CAAa,CAAb,EAAgB,OAAOT,QAAQU,SAAf,KAA6B,QAA7B,GAAwCV,QAAQU,SAAhD,GAA4DhB,mBAA5E,CAAT;;AAEA,UAAOK,MAAP;AACA,GAzBD;;AA2BAY,SAAOC,OAAP,GAAiBd,UAAjB","file":"filenamify.js","sourcesContent":["'use strict';\nconst trimRepeated = require('trim-repeated');\nconst filenameReservedRegex = require('filename-reserved-regex');\nconst stripOuter = require('strip-outer');\n\n// Doesn't make sense to have longer filenames\nconst MAX_FILENAME_LENGTH = 100;\n\nconst reControlChars = /[\\u0000-\\u001f\\u0080-\\u009f]/g; // eslint-disable-line no-control-regex\nconst reRelativePath = /^\\.+/;\nconst reTrailingPeriods = /\\.+$/;\n\nconst filenamify = (string, options = {}) => {\n\tif (typeof string !== 'string') {\n\t\tthrow new TypeError('Expected a string');\n\t}\n\n\tconst replacement = options.replacement === undefined ? '!' : options.replacement;\n\n\tif (filenameReservedRegex().test(replacement) && reControlChars.test(replacement)) {\n\t\tthrow new Error('Replacement string cannot contain reserved filename characters');\n\t}\n\n\tstring = string.replace(filenameReservedRegex(), replacement);\n\tstring = string.replace(reControlChars, replacement);\n\tstring = string.replace(reRelativePath, replacement);\n\tstring = string.replace(reTrailingPeriods, '');\n\n\tif (replacement.length > 0) {\n\t\tstring = trimRepeated(string, replacement);\n\t\tstring = string.length > 1 ? stripOuter(string, replacement) : string;\n\t}\n\n\tstring = filenameReservedRegex.windowsNames().test(string) ? string + replacement : string;\n\tstring = string.slice(0, typeof options.maxLength === 'number' ? options.maxLength : MAX_FILENAME_LENGTH);\n\n\treturn string;\n};\n\nmodule.exports = filenamify;\n"]}