{"version":3,"sources":["DataClient.js"],"names":["Object","defineProperty","exports","value","DataClient","_LRUCache","require","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","_createClass","protoProps","staticProps","prototype","_ref","arguments","undefined","storageMaxSize","cache","LRUCache","currentPromises","cursors","read","get","update","Promise","Error","set","isFetching","getCursor","setCursor"],"mappings":"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","file":"DataClient.js","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.DataClient = void 0;\n\nvar _LRUCache = require(\"./LRUCache\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nvar DataClient = /*#__PURE__*/function () {\n  function DataClient() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        storageMaxSize = _ref.storageMaxSize;\n\n    _classCallCheck(this, DataClient);\n\n    this.cache = new _LRUCache.LRUCache(storageMaxSize);\n    this.currentPromises = {};\n    this.cursors = {};\n  }\n\n  _createClass(DataClient, [{\n    key: \"read\",\n    value: function read(key) {\n      if (!key) {\n        return null;\n      }\n\n      return this.cache.get(key);\n    }\n  }, {\n    key: \"update\",\n    value: function update(key, value) {\n      if (!key) {\n        return null;\n      }\n\n      if (value instanceof Promise || value instanceof Error) {\n        this.currentPromises[key] = value;\n      } else {\n        this.cache.set(key, value);\n      }\n    }\n  }, {\n    key: \"isFetching\",\n    value: function isFetching(key) {\n      if (!key) {\n        return;\n      }\n\n      return this.currentPromises[key];\n    }\n  }, {\n    key: \"getCursor\",\n    value: function getCursor(key) {\n      if (!key) {\n        return null;\n      }\n\n      return this.cursors[key];\n    }\n  }, {\n    key: \"setCursor\",\n    value: function setCursor(key, value) {\n      if (!key) {\n        return null;\n      }\n\n      this.cursors[key] = value;\n    }\n  }]);\n\n  return DataClient;\n}();\n\nexports.DataClient = DataClient;"]}